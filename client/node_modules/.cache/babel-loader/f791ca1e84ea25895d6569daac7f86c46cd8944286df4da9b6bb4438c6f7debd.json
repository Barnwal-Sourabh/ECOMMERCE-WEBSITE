{"ast":null,"code":"import _regeneratorRuntime from\"D:/Projects/ECOMMERCE WEBSITE/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Projects/ECOMMERCE WEBSITE/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from\"react\";import\"./Cart.scss\";import DeleteOutlinedIcon from\"@mui/icons-material/DeleteOutlined\";import{useSelector}from\"react-redux\";import{removeItem,resetCart}from\"../../redux/cartReducer\";import{useDispatch}from\"react-redux\";import{makeRequest}from\"../../makeRequest\";import{loadStripe}from\"@stripe/stripe-js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Cart=function Cart(){var products=useSelector(function(state){return state.cart.products;});var dispatch=useDispatch();var totalPrice=function totalPrice(){var total=0;products.forEach(function(item){total+=item.quantity*item.price;});return total.toFixed(2);};var stripePromise=loadStripe(\"pk_test_51NYmqTSIa7AQMAk5dCsgoTKCifjbwXyEW4EA3NMKEuk3JZYzqqmtK2UEOJR6HnPSBS5gME4qAQZFUTTZf44r64B700YFarAuUI\");var handlePayment=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var stripe,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return stripePromise;case 3:stripe=_context.sent;_context.next=6;return makeRequest.post(\"/orders\",{products:products});case 6:res=_context.sent;_context.next=9;return stripe.redirectToCheckout({sessionId:res.data.stripeSession.id});case 9:_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 14:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));return function handlePayment(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"cart\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Products in your cart\"}),products===null||products===void 0?void 0:products.map(function(item){var _item$desc;return/*#__PURE__*/_jsxs(\"div\",{className:\"item\",children:[/*#__PURE__*/_jsx(\"img\",{src:process.env.REACT_APP_UPLOAD_URL+item.img,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"details\",children:[/*#__PURE__*/_jsx(\"h1\",{children:item.title}),/*#__PURE__*/_jsx(\"p\",{children:(_item$desc=item.desc)===null||_item$desc===void 0?void 0:_item$desc.substring(0,100)}),/*#__PURE__*/_jsxs(\"div\",{className:\"price\",children:[item.quantity,\" x $\",item.price]})]}),/*#__PURE__*/_jsx(DeleteOutlinedIcon,{className:\"delete\",onClick:function onClick(){return dispatch(removeItem(item.id));}})]},item.id);}),/*#__PURE__*/_jsxs(\"div\",{className:\"total\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"SUBTOTAL\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",totalPrice()]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handlePayment,children:\"PROCEED TO CHECKOUT\"}),/*#__PURE__*/_jsx(\"span\",{className:\"reset\",onClick:function onClick(){return dispatch(resetCart());},children:\"Reset Cart\"})]});};export default Cart;","map":{"version":3,"names":["React","DeleteOutlinedIcon","useSelector","removeItem","resetCart","useDispatch","makeRequest","loadStripe","jsx","_jsx","jsxs","_jsxs","Cart","products","state","cart","dispatch","totalPrice","total","forEach","item","quantity","price","toFixed","stripePromise","handlePayment","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","stripe","res","wrap","_callee$","_context","prev","next","sent","post","redirectToCheckout","sessionId","data","stripeSession","id","t0","console","log","stop","apply","arguments","className","children","map","_item$desc","src","process","env","REACT_APP_UPLOAD_URL","img","alt","title","desc","substring","onClick"],"sources":["D:/Projects/ECOMMERCE WEBSITE/client/src/components/Cart/Cart.jsx"],"sourcesContent":["import React from \"react\";\r\nimport \"./Cart.scss\";\r\nimport DeleteOutlinedIcon from \"@mui/icons-material/DeleteOutlined\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { removeItem, resetCart } from \"../../redux/cartReducer\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { makeRequest } from \"../../makeRequest\";\r\nimport { loadStripe } from \"@stripe/stripe-js\";\r\n\r\nconst Cart = () => {\r\n  const products = useSelector((state) => state.cart.products);\r\n  const dispatch = useDispatch();\r\n\r\n  const totalPrice = () => {\r\n    let total = 0;\r\n    products.forEach((item) => {\r\n      total += item.quantity * item.price;\r\n    });\r\n    return total.toFixed(2);\r\n  };\r\n\r\n  const stripePromise = loadStripe(\r\n    \"pk_test_51NYmqTSIa7AQMAk5dCsgoTKCifjbwXyEW4EA3NMKEuk3JZYzqqmtK2UEOJR6HnPSBS5gME4qAQZFUTTZf44r64B700YFarAuUI\"\r\n  );\r\n  const handlePayment = async () => {\r\n    try {\r\n      const stripe = await stripePromise;\r\n      const res = await makeRequest.post(\"/orders\", {\r\n        products,\r\n      });\r\n      await stripe.redirectToCheckout({\r\n        sessionId: res.data.stripeSession.id,\r\n      });\r\n\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n  return (\r\n    <div className=\"cart\">\r\n      <h1>Products in your cart</h1>\r\n      {products?.map((item) => (\r\n        <div className=\"item\" key={item.id}>\r\n          <img src={process.env.REACT_APP_UPLOAD_URL + item.img} alt=\"\" />\r\n          <div className=\"details\">\r\n            <h1>{item.title}</h1>\r\n            <p>{item.desc?.substring(0, 100)}</p>\r\n            <div className=\"price\">\r\n              {item.quantity} x ${item.price}\r\n            </div>\r\n          </div>\r\n          <DeleteOutlinedIcon\r\n            className=\"delete\"\r\n            onClick={() => dispatch(removeItem(item.id))}\r\n          />\r\n        </div>\r\n      ))}\r\n      <div className=\"total\">\r\n        <span>SUBTOTAL</span>\r\n        <span>${totalPrice()}</span>\r\n      </div>\r\n      <button onClick={handlePayment}>PROCEED TO CHECKOUT</button>\r\n      <span className=\"reset\" onClick={() => dispatch(resetCart())}>\r\n        Reset Cart\r\n      </span>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Cart;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}